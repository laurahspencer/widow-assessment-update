# Tables 

## Data

### Fishery-dependent data
 
```{r} 
#| label: 'set-rda-dir-tbls'
#| echo: false 
#| warning: false 
#| eval: true 
#| include: false
library(flextable)

# You can save tables to read in as csv or rda files.
# stockplotr generally uses rda files.
# I (Kiva) prefer csv files because they are text files that are easier to track and preview with version control.

# There are many ways to incorporate tables into quarto documents.
# One is using the flextable package via R chunks.
# For help: https://ardata-fr.github.io/flextable-book/

``` 

```{r}
#| label: tbl-all_removals
#| echo: false
#| warning: false
#| tbl-cap: "Landings for bottom trawl, midwater trawl, net, and hook-and-line (mt) fisheries from Washington, Oregon, and California."

#table 1

# CatchTable <- read.csv("Tables/CatchTable.csv")%>%
# select(-ComModelTotal)
# CatchTable[is.na(CatchTable)] <- 0
# CatchTable |>
#   gt() |>
#  cols_label(
#     year = "Year",
#     ComWA = "Com. WA",
#     ComOR = "Com. OR",
#     ComCA = "Com. CA",
#     ComDiscards = "Com. Discards",
#     Foreign = "For.",
#     RecWA = "Rec. WA",
#     RecOR = "Rec. OR",
#     RecCA = "Rec. CA",
#   ) |> 
#   tab_options(
#     table.font.size = 12,
#     latex.use_longtable = TRUE
#   ) |>
#   as_latex()

```
:::
{{< pagebreak >}}

```{r}
#| label: tbl-hake_removals
#| echo: false
#| warning: false
#| tbl-cap: " Landings (mt) from the foreign & domestic at-sea fleet and the domestic shoreside hake fleet. Catches (mt) from the Pacific whiting at-sea fishery as determined by onboard observers."

library(flextable)
library(dplyr)
library(tidyr)

HakeTable<- read.csv(file.path(here::here(),"report/tables/Table_2_2025.csv"))
flextable(HakeTable) %>%
  colformat_num(j = 1, big.mark = "", digits = 0) %>%
font(fontname = "Times New Roman", part = "all") %>%
  border_outer(part = "all") %>%
  border_inner(part = "all") 

```

:::
{{< pagebreak >}}

```{r}
#| label: tbl-manage-act
#| echo: false
#| warning: false
#| tbl-cap: "A subset of management actions of importance to fisheries that caught Widow Rockfish."

library(flextable)
library(dplyr)
library(tidyr)
ManageTable<- read.csv(file.path(here::here(),"report/tables/Table_3_2025.csv"))
colnames(ManageTable) <- c("Year","Management action")

ManageTable<- ManageTable %>%
  group_by(Year)%>%
  ungroup()
  # mutate(Year_Display = ifelse(row_number() == 1, as.character(Year), "")) %>%
  

flextable(ManageTable) %>%
  set_header_labels(Year = "Year", `Management action` = "Management action") %>%
  merge_v(j = "Year") %>%
  align(j = "Year", align = "center", part = "all") %>%
  align(j = "Management action", align = "left", part = "all") %>%
  font(fontname = "Times New Roman", part = "all") %>%
  border_outer(part = "all") %>%
  border_inner(part = "all") %>%
  colformat_num(j = 1, big.mark = "", digits = 0) %>%
  flextable::width(j = "Year", width = 0.7) %>%  # Year column width
  flextable::width(j = "Management action", width = 5)   # Management action column width


# select(-ComModelTotal)
# CatchTable[is.na(CatchTable)] <- 0
# CatchTable |>
#   gt() |>
#  cols_label(
#     year = "Year",
#     ComWA = "Com. WA",
#     ComOR = "Com. OR",
#     ComCA = "Com. CA",
#     ComDiscards = "Com. Discards",
#     Foreign = "For.",
#     RecWA = "Rec. WA",
#     RecOR = "Rec. OR",
#     RecCA = "Rec. CA",
#   ) |> 
#   tab_options(
#     table.font.size = 12,
#     latex.use_longtable = TRUE
#   ) |>
#   as_latex()

```


:::
{{< pagebreak >}}

```{r}
#| label: tbl-depth-surv
#| echo: false
#| warning: false
#| tbl-cap: "Depth ranges and limits of the southern latitude in the Triennial survey for the different years."

#Old table 6

library(flextable)
library(dplyr)
library(tidyr)

table6_data <- as.data.frame(read.csv(file.path(here::here(),"report/tables/table6.csv"), stringsAsFactors = FALSE))


# Function for consistent table styling
style_flextable <- function(ft) {
  ft %>%
    font(fontname = "Times New Roman", part = "all") %>%
    border_outer(part = "all") %>%
    border_inner(part = "all") %>%
    align(align = "center", part = "header") %>%
    align(align = "center", part = "body")
}

# Create Flextable for Table 6
table6_data %>%
  flextable() %>%
  set_header_labels(
    Years = "Years",
    Depth_range_m = "Depth range (m)",
    Southern_latitude = "Southern latitude"
  ) %>%
  style_flextable()





```


```{r}
#| label: tbl-strat-surv
#| echo: false
#| warning: false
#| tbl-cap: "Stratifications used for the two surveys."

library(flextable)
library(dplyr)
library(tidyr)

table7_nwfsc_data <- as.data.frame(read.csv(file.path(here::here(),"report/tables/table7_nwfsc.csv"), stringsAsFactors = FALSE))

table7_triennial_data <- as.data.frame(read.csv(file.path(here::here(),"report/tables/table7_triennial.csv"), stringsAsFactors = FALSE))

# Function for consistent table styling
style_flextable <- function(ft) {
  ft %>%
    font(fontname = "Times New Roman", part = "all") %>%
    border_outer(part = "all") %>%
    border_inner(part = "all") %>%
    align(align = "center", part = "header") %>%
    align(align = "center", part = "body")
}

# Create Flextable for Table 7 (Triennial)
table7_triennial_data %>%
  flextable() %>%
  set_header_labels(
    Strata = "Strata",
    Area_km2 = "Area (km2)",
    Depth1 = "Depth1",
    Depth2 = "Depth2",
    Latitude1 = "Latitude1",
    Latitude2 = "Latitude2"
  ) %>%
  add_header_row(values = c("Triennial"), colwidths = 6) %>%
  style_flextable()

# Create Flextable for Table 7 (NWFSC WCGBT)
table7_nwfsc_data %>%
  flextable() %>%
  set_header_labels(
    Strata = "Strata",
    Area_km2 = "Area (km2)",
    Depth1 = "Depth1",
    Depth2 = "Depth2",
    Latitude1 = "Latitude1",
    Latitude2 = "Latitude2"
  ) %>%
  add_header_row(values = c("NWFSC WCGBT"), colwidths = 6) %>%
  style_flextable()



```

:::
{{< pagebreak >}}

```{r}
#| label: tbl-age-error
#| echo: false
#| warning: false
#| tbl-cap: "Ageing error for two labs that was used in the assessment model."

#Old table 20

library(flextable)
library(dplyr)
library(tidyr)
library(officer)

table20<- as.data.frame(read.csv(file.path(here::here(),"report/tables/table20.csv"), stringsAsFactors = FALSE))


# Function for consistent table styling
style_table20 <- function(ft) {
  ft %>%
    font(fontname = "Times New Roman", part = "all") %>%
    border_outer(part = "all") %>%
    border_inner(part = "all") %>%
    align(align = "center", part = "header") %>%
    align(align = "center", part = "body")
}
# Create Flextable for Table 20
ft_table20 <- table20 %>%
  flextable() %>%
  set_header_labels(
    True.Age = "True Age",
    Standard.Deviation.CAP = "Standard Deviation CAP",
    Standard.Deviation.SWFSC = "Standard Deviation SWFSC"
  ) %>%
  style_table20()

print(ft_table20)



```



