---
title: 'Stock Assessment Update: Status of Widow Rockfish Stock  (Sebastes entomelas) off the U.S. West Coast in 2025'
author:
  - name: 'Michael Kinneen'
    affiliations:
      - name: 'School of Aquatic & Fishery Sciences (SAFS), University of Washington'
        address: '1122 NE Boat St'
        city: 'Seattle'
        state: 'WA'
        postal-code: '98195'

  - name: 'Maurice Goodman'
    affiliations:
      - name: 'School of Aquatic & Fishery Sciences (SAFS), University of Washington'
        address: '1122 NE Boat St'
        city: 'Seattle'
        state: 'WA'
        postal-code: '98195'

  - name: 'Anna Sulc'
    affiliations:
      - name: 'School of Aquatic & Fishery Sciences (SAFS), University of Washington'
        address: '1122 NE Boat St'
        city: 'Seattle'
        state: 'WA'
        postal-code: '98195'

  - name: 'Laurinne Balstad'
    affiliations:
      - name: 'Department of Environmental Science and Policy, University of California Davis'
        address: 'Wickson Hall, 350 N Quad'
        city: 'Davis'
        state: 'CA'
        postal-code: '95616'

  - name: 'Raquel Ruiz Diaz'
    affiliations:
      - name: 'School of Aquatic & Fishery Sciences (SAFS), University of Washington'
        address: '1122 NE Boat St'
        city: 'Seattle'
        state: 'WA'
        postal-code: '98195'

  - name: 'Kristina Randrup'
    affiliations:
      - name: 'School of Aquatic & Fishery Sciences (SAFS), University of Washington'
        address: '1122 NE Boat St'
        city: 'Seattle'
        state: 'WA'
        postal-code: '98195'

  - name: 'Will Patrone'
    affiliations:
      - name: 'School of Aquatic & Fishery Sciences (SAFS), University of Washington'
        address: '1122 NE Boat St'
        city: 'Seattle'
        state: 'WA'
        postal-code: '98195'

  - name: 'Laura Spencer'
    affiliations:
      - name: 'School of Aquatic & Fishery Sciences (SAFS), University of Washington'
        address: '1122 NE Boat St'
        city: 'Seattle'
        state: 'WA'
        postal-code: '98195'

  - name: 'Alaia Morell'
    affiliations:
      - name: 'UW Puget Sound Institute, Center for Urban Waters'
        address: '326 East D Street'
        city: 'Tacoma'
        state: 'WA'
        postal-code: '98421-1801'

  - name: 'Alberto Rovellini'
    affiliations:
      - name: 'School of Aquatic & Fishery Sciences (SAFS), University of Washington'
        address: '1122 NE Boat St'
        city: 'Seattle'
        state: 'WA'
        postal-code: '98195'

  - name: 'Allison Dedrick'
    affiliations:
      - name: 'California Department of Fish and Wildlife'
        address: '1740 North Market Boulevard'
        city: 'Sacramento'
        state: 'CA'
        postal-code: '95834'

  - name: 'Nick Grunloh'
    affiliations:
      - name: 'Southwest Fisheries Science Center'
        address: '8901 La Jolla Shores Drive'
        city: 'La Jolla'
        state: 'CA'
        postal-code: '92037-1508'

  - name: 'Madison Bargas'
    affiliations:
      - name: 'Coastal Oregon Marine Experiment Station, Oregon State University'
        address: '430 Strand Agriculture Hall'
        city: 'Corvallis'
        state: 'OR'
        postal-code: '97331'

  - name: 'Stephanie Hopkins'
    affiliations:
      - name: "University of California, Santa Cruz, Institute of Marine Sciencesâ€™ Fisheries Collaborative Program"
        address: '1156 High Street'
        city: 'Santa Cruz'
        state: 'CA'
        postal-code: '95064'

  - name: 'Vladlena Gertseva'
    affiliations:
      - name: 'NOAA Fisheries Northwest Fisheries Science Center'
        address: '2725 Montlake Boulevard East'
        city: 'Seattle'
        state: 'WA'
        postal-code: '98112-2097'

  - name: 'Ian G. Taylor'
    affiliations:
      - name: 'NOAA Fisheries Northwest Fisheries Science Center'
        address: '2725 Montlake Boulevard East'
        city: 'Seattle'
        state: 'WA'
        postal-code: '98112-2097'

  - name: 'Melissa A. Haltuch'
    affiliations:
      - name: 'NOAA Alaska Fisheries Science Center'
        address: '7600 Sand Point Way N.E., Building 4'
        city: 'Seattle'
        state: 'WA'
        postal-code: '98115'
        
  - name: 'Owen Hamel'
    affiliations:
      - name: 'NOAA Fisheries Northwest Fisheries Science Center'
        address: '2725 Montlake Boulevard East'
        city: 'Seattle'
        state: 'WA'
        postal-code: '98112-2097'


date: today
lang: en
keep-tex: true
cover:
pdf-engine: lualatex
format:
  pdf:
    documentclass: scrartcl
    number-sections: true
    template-partials:
      - 'support_files/before-body.tex'
      - 'support_files/_titlepage.tex'
    include-in-header:
      - 'support_files/in-header.tex'
      - 'support_files/pfmc.tex'
      - text: '\lohead{SPECIES assessment 2025}'
    toc: true
    lof: false
    lot: false
    titlepage-geometry:
      - top=2in
      - bottom=1in
      - right=1in
      - left=1in
output-file: 'WIDOW_SAR_2025'
params:
  office: 'NWFSC'
  species: 'Widow Rockfish'
  spp_latin: 'Sebastes entomelas'
  region: 'U.S. West Coast'
bibliography:
  - asar_references.bib
---

```{r}
#| label: 'read_base_model'
#| eval: true
#| echo: false
#| message: false
#| warning: false

library(here)
library(dplyr)

# source(here('Rscripts/table_sens.R'))

# TODO list of things to update when changing the base model:
# - [ ] run Rscripts/make_r4ss_figs_tables.R
# - [ ] run Rscripts/run_diagnostics.R
# - [ ] run Rscripts/sensitivities.R
# - [ ] update any hardwired values in the text (or make them dynamic)
#   - [ ] text on 2019 discards "inadvertently left out of the base model"
#   - [ ] 
# base_mod <- '5.09_no_extra_se'
# mod_in <- r4ss::SS_read(here('model_runs', base_mod))
# mod_out <- r4ss::SS_output(here('model_runs', base_mod), verbose = FALSE, printstats = FALSE)

```

```{r} 
#| label: 'output_and_quantities'
#| echo: false 
#| warning: false 
#| eval: false 
# load converted output from asar::convert_output() 
output <- utils::read.csv('/') 
# Call reference points and quantities below 
output <- output |> 
  dplyr::mutate(estimate = as.numeric(estimate), 
    uncertainty = as.numeric(uncertainty)) 
start_year <- as.numeric(min(output$year, na.rm = TRUE)) 
end_year <- (output |> 
  dplyr::filter(!(year %in% c('Virg', 'Init', 'S/Rcurve', 'INIT')), 
    !is.na(year)) |> 
  dplyr::mutate(year = as.numeric(year)) |> 
  dplyr::summarize(max_val = max(year)) |> 
  dplyr::pull(max_val))-10
# subset output to remove quantities that are split by factor 
output2 <- output |> 
  dplyr::filter(is.na(season), 
    is.na(fleet), 
    is.na(sex), 
    is.na(area), 
    is.na(growth_pattern), 
    is.na(subseason), 
    is.na(age))
# terminal fishing mortality 
Fend <- output2 |> 
  dplyr::filter(c(label == 'fishing_mortality' & year == end_year) | c(label == 'terminal_fishing_mortality' & is.na(year))) |>
  dplyr::pull(estimate)
# fishing mortality at msy 
# please change target if desired 
Ftarg <- output2 |>
  dplyr::filter(grepl('f_target', label) | grepl('f_msy', label) | c(grepl('fishing_mortality_msy', label) & is.na(year))) |>
  dplyr::pull(estimate)
# Terminal year F respective to F target 
F_Ftarg <- Fend / Ftarg
# terminal year biomass 
Bend <- output2 |>
  dplyr::filter(grepl('mature_biomass', label) | grepl('^biomass$', label),
    year == end_year) |>
  dplyr::pull(estimate)
# target biomass (msy) 
# please change target if desired 
Btarg <- output2 |>
  dplyr::filter(c(grepl('biomass', label) & grepl('target', label) & estimate >1) | label == 'biomass_msy') |>
  dplyr::pull(estimate)
# total catch in the last year 
total_catch <- output |>
  dplyr::filter(grepl('^catch$', label), 
  year == end_year,
    is.na(fleet),
    is.na(age),
    is.na(area),
    is.na(growth_pattern)) |>
  dplyr::pull(estimate)
# total landings in the last year 
total_landings <- output |>
  dplyr::filter(grepl('landings_weight', label), year == end_year,
    is.na(fleet),
    is.na(age)) |>
  dplyr::pull(estimate)
# spawning biomass in the last year
sbend <- output2 |>
  dplyr::filter(grepl('spawning_biomass', label), year == end_year) |>
  dplyr::pull(estimate) |>
    unique()
# overall natural mortality or at age 
M <- output |>
  dplyr::filter(grepl('natural_mortality', label)) |>
  dplyr::pull(estimate)
# Biomass at msy 
# to change to another reference point, replace msy in the following lines with other label 
Bmsy <- output2 |>
  dplyr::filter(c(grepl('biomass', label) & grepl('msy', label) & estimate >1) | label == 'biomass_msy') |>
  dplyr::pull(estimate)
# target spawning biomass(msy) 
# please change target if desired 
SBtarg <- output2 |>
  dplyr::filter(c(grepl('spawning_biomass', label) & grepl('msy$', label) & estimate >1) | label == 'spawning_biomass_msy$') |>
  dplyr::pull(estimate)
# steepness 
h <- output |> 
  dplyr::filter(grepl('steep', label)) |> 
  dplyr::pull(estimate)
# recruitment 
R0 <- output |> 
  dplyr::filter(grepl('R0', label) | grepl('recruitment_virgin', label)) |> 
  dplyr::pull(estimate)
# female SB (placeholder)

``` 

{{< pagebreak >}} 

Please cite this publication as: 

M. Kinneen, M. Goodman, A. Sulc, L. Balstad, R. Diaz, K. Randrup, W. Patrone, L. Spencer, A. Morell, A. Rovellini, A. Dedrick, N. Grunloh, M.Bargas, S.Hopkins, V. Gersteva, K. Ohen, I. Taylor, M. Haltuch, O. Hamel (2025) Stock Assessment Update: Status of Widow Rockfish (Sebastes entomelas) Along the U.S. West Coast in 2025. Pacific Fishery Management Council, Portland, Oregon.

{{< pagebreak >}} 

\pagenumbering{roman}
\setcounter{page}{1}

\renewcommand{\thetable}{\roman{table}}
\renewcommand{\thefigure}{\roman{figure}}

```{r, results='asis'}
#| label: 'disclaimer'
#| eval: true
#| echo: false
#| warning: false
a <- knitr::knit_child('00a_disclaimer.qmd', quiet = TRUE)
cat(a, sep = '\n')
```

 {{< pagebreak >}} 

```{r, results='asis'}
#| label: 'executive_summary'
#| eval: true
#| echo: false
#| warning: false
a <- knitr::knit_child('01_executive_summary.qmd', quiet = TRUE)
cat(a, sep = '\n')
```

 {{< pagebreak >}} 

\setlength{\parskip}{5mm plus1mm minus1mm}
\pagenumbering{arabic}
\setcounter{page}{1}
\setcounter{section}{0}
\renewcommand{\thefigure}{\arabic{figure}}
\renewcommand{\thetable}{\arabic{table}}
\setcounter{table}{0}
\setcounter{figure}{0}


```{r, results='asis'}
#| label: 'introduction'
#| eval: true
#| echo: false
#| warning: false
a <- knitr::knit_child('02_introduction.qmd', quiet = TRUE)
cat(a, sep = '\n')
```

 {{< pagebreak >}} 

```{r, results='asis'}
#| label: 'data'
#| eval: true
#| echo: false
#| warning: false
a <- knitr::knit_child('03_data.qmd', quiet = TRUE)
cat(a, sep = '\n')
```

 {{< pagebreak >}} 

```{r, results='asis'}
#| label: 'assessment-configuration'
#| eval: true
#| echo: false
#| warning: false
a <- knitr::knit_child('04a_model_summary.qmd', quiet = TRUE)
cat(a, sep = '\n')
```

```{r, results='asis'}
#| label: 'assessment-sensitivity'
#| eval: true
#| echo: false
#| warning: false
a <- knitr::knit_child('04b_model_results.qmd', quiet = TRUE)
cat(a, sep = '\n')
```

```{r, results='asis'}
#| label: 'assessment-benchmarks'
#| eval: true
#| echo: false
#| warning: false
a <- knitr::knit_child('04c_model_diagnostics.qmd', quiet = TRUE)
cat(a, sep = '\n')
```

 {{< pagebreak >}} 

```{r, results='asis'}
#| label: 'discussion'
#| eval: true
#| echo: false
#| warning: false
a <- knitr::knit_child('05_management.qmd', quiet = TRUE)
cat(a, sep = '\n')
```

 {{< pagebreak >}} 

```{r, results='asis'}
#| label: 'acknowledgments'
#| eval: true
#| echo: false
#| warning: false
a <- knitr::knit_child('06_acknowledgments.qmd', quiet = TRUE)
cat(a, sep = '\n')
```


 {{< pagebreak >}} 

```{r, results='asis'}
#| label: 'tables'
#| eval: true
#| echo: false
#| warning: false
a <- knitr::knit_child('08_tables.qmd', quiet = TRUE)
cat(a, sep = '\n')
```

 {{< pagebreak >}} 

```{r, results='asis'}
#| label: 'figures'
#| eval: true
#| echo: false
#| warning: false
a <- knitr::knit_child('09_figures.qmd', quiet = TRUE)
cat(a, sep = '\n')
```

 {{< pagebreak >}} 

```{r, results='asis'}
#| label: 'references'
#| eval: true
#| echo: false
#| warning: false
a <- knitr::knit_child('07_references.qmd', quiet = TRUE)
cat(a, sep = '\n')
```

 {{< pagebreak >}} 

```{r, results='asis'}
#| label: 'appendix'
#| eval: true
#| echo: false
#| warning: false
a <- knitr::knit_child('10_appendix.qmd', quiet = TRUE)
cat(a, sep = '\n')
```

